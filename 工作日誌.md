## 日期：2025年6月27日
## 專案日誌：MQ 直立式廣告機內容管理系統 v3.6
---
### 🚀 新增功能
1. **群組圖片上傳體驗優化**
   - 圖片上傳成功後，不再彈出「上傳成功」提示，也不再自動重新整理頁面。
   - 而是即時更新「已選圖片」和「所有可用圖片」列表，提升使用者操作流暢度。

### 🛠️ 更新-改進
1. **前端 API 呼叫邏輯強化**
   - 統一使用 `fetchWithAuth` 處理所有需要 JWT 認證的 API 請求，確保 Token 正確傳遞。
   - 攔截表單預設提交行為，改為透過 JavaScript 發送非同步請求。
2. **後端 API 支援擴展**
   - 新增 `/api/assignments/<assignment_id>` 的 `DELETE` 路由，支援前端刪除指派操作。
3. **後台介面重構**
   - 根據新的線框圖 (New Mockup 1.png) 重新設計 `admin.html` 頁面佈局。
   - 使用 Bulma CSS 的 `columns` 和 `column` class 實現了 2x2 的網格佈局，將四個主要功能區塊（新增媒體、全局設定、媒體庫、輪播組管理）重新排列。
   - 提升了頁面的視覺清晰度和操作直覺性。
   **CSS 樣式外部化**
   - 將原先在 `admin.html` 中所有的內聯 `<style>` 規則抽取出來。
   - 建立了一個新的專用樣式表 `static/css/admin.css` 來存放這些規則。
   - `admin.html` 現在透過 `<link>` 標籤引用此外部樣式表，使 HTML 結構更乾淨，也讓樣式更易於管理和快取。

### 🐛 BUG 修復
- **刪除操作「Method Not Allowed」錯誤**：
  - 修正了前端刪除素材、指派、輪播群組時，因 HTTP 方法不正確導致的「Method Not Allowed」錯誤。
  - 確保前端對應的 `DELETE` 或 `POST` 請求發送到正確的後端 API 端點。
- **刪除輪播群組時圖片清理不完整**：
  - 修正了刪除輪播群組時，未能正確清理所有群組專屬圖片的問題。
  - 優化了後端查詢邏輯，確保所有相關圖片都能被正確刪除。
- **建立群組「Token is missing!」錯誤**：
  - 解決了建立輪播群組時，因未攜帶 JWT 認證資訊導致的「Token is missing!」錯誤。
  - 前端現在會正確地將 JWT Token 包含在建立群組的請求中。
- **指派輪播組時「指派到區塊」下拉選單消失**：
  - 修正了在「新增媒體 / 指派內容」中選擇「指派輪播組」時，區塊下拉選單錯誤隱藏的問題。
  - 確保 `toggleFormFields` 函式在處理 `group_reference` 類型時，正確顯示相關欄位。
- **指派輪播組時「不支援的操作類型」錯誤**：
  - 解決了前端傳遞的 `type` 值與後端預期不符導致的「不支援的操作類型」錯誤。
  - 將前端 `templates/admin.html` 中「指派輪播組」選項的 `value` 從 `carousel_reference` 修改為 `group_reference`，使其與後端匹配。

### 📝 備註
- 本次更新主要集中於提升前端互動的穩定性與使用者體驗，並完善了後端 API 的支援。