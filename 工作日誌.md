## 2025年6月30日  
### MQ 直立式廣告機內容管理系統 v3.10.0

---

### 🚀 新增功能
<!-- 尚未新增功能，請於此補充 -->

---

### 🛠️ 更新與改進

- **依賴管理與環境隔離**：為專案建立了全新、完全隔離的 Python 虛擬環境（venv），解決先前因繼承系統全域套件所導致的依賴混亂問題。
- **部署配置標準化**：產生乾淨、精確的 `requirements.txt`，僅包含專案運行必要套件，大幅提升新環境部署的可靠性與速度。
- **端口配置靈活性**：將應用程式預設監聽端口由 5000 改為 5003，避開 macOS 與伺服器常見端口衝突。
- **文檔完善**：更新 `README.md`，新增詳細「安裝與啟動指南」，標準化虛擬環境建立、依賴安裝、防火牆設定等步驟。
- **顯示邏輯重構**：將原有固定像素（px）佈局，全面重構為使用 viewport width（vw）單位的等比例縮放佈局。
- **跨裝置一致性**：確保頁面於手機、平板、電腦及 1080x1920 直立廣告機上，皆維持「頁首＋四宮格＋頁尾」固定結構並等比例縮放，取代原先會變動排版的響應式設計（RWD）。
- **前端架構現代化重構**：完成了對核心後台腳本 `static/js/admin.js` 的全面重構，將其從單體式架構升級為現代化的模組化架構。
- **導入狀態管理模式**：建立了統一的狀態管理中心 (`store.js`)，實現了由狀態驅動 UI 更新的單向資料流模式，大幅提升了程式碼的可預測性和可維護性。
- **關注點分離 (SoC)**：成功將原本混合的邏輯拆分為四個獨立的模組：  
  - `api.js`：專門處理所有網路請求。  
  - `store.js`：集中管理應用程式狀態。  
  - `ui.js`：負責所有 DOM 的渲染與更新。  
  - `eventHandlers.js`：統一處理所有使用者互動事件。
- **統一前端渲染邏輯**：重構了 `animation.js` 中的渲染函數，確保所有輪播區塊（包括頁首、頁尾和中間四宮格）都使用相同的邏輯來生成一致的 DOM 結構。

---

### 🐛 BUG 修復

- **修復輪播顯示黑畫面問題**：解決了輪播區塊中，當有多張圖片時，從第二張開始顯示為黑畫面的問題。此問題因 CSS 中對輪播項目內的媒體元素（圖片/影片）使用了 `position: absolute`，導致所有圖片堆疊在一起，而非水平排列。已透過移除絕對定位，使其恢復正常的 Flexbox 排列來修復。
- **本地開發環境啟動失敗**：解決 macOS 上因「AirPlay 接收器」佔用 5000 端口導致的 `Address already in use` 錯誤，提升開發體驗。
- **依賴缺失導致的功能錯誤**：於新環境中補全如 eventlet、PyJWT 等必要套件，解決 `Invalid async_mode specified` 及 `module 'jwt' has no attribute 'encode'` 等錯誤。
- **修復佈局錯亂問題**：根本解決不同尺寸設備下因固定寬度或不當 RWD 導致的元素重疊、內容裁切及版面跑版問題。
- **診斷連線錯誤**：釐清後端未啟動時前端出現 `net::ERR_CONNECTION_REFUSED` 屬正常預期，非系統 Bug。
- **修復 Modal 狀態不同步問題**：解決了在輪播群組編輯視窗中上傳新圖片後，圖片列表不會即時更新的 Bug。現在，任何狀態的改變都會觸發已開啟 Modal 內容的重新渲染。
- **修復輪播顯示黑畫面問題**：解決了中間四宮格區塊輪播第二張及之後的圖片時會顯示黑畫面的問題。此問題源於 DOM 結構不一致，現已透過統一渲染邏輯徹底修復。

---

### 📅 下一步計劃

1. 前端狀態管理優化：進一步模組化前端代碼
2. 自動化測試：添加完整單元測試與整合測試
3. 使用者管理功能：實現完整使用者管理介面
4. 性能優化：添加快取機制與分頁功能
5. API 版本控制：為未來 API 變更做準